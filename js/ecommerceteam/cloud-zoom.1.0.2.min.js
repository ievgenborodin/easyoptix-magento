/**
 * Easy Optix
 *
 * @author      Ievgen Borodin
 * @copyright   Copyright (c) 2016 EasyOptix Inc. (http://www.easy-optix.com)
 */

!function($){function format(a){for(var b=1;b<arguments.length;b++)a=a.replace("%"+(b-1),arguments[b]);return a}function CloudZoom(a,b){var c,d,e,f,g,h,i,j,k=$("img",a),l=$(".product-shop"),m=null,n=null,o=null,p=null,q=null,r=null,s=0,t=0,u=0,v=0,w=0,x=0,y=this;setTimeout(function(){if(null===n){var b=a.width();a.parent().append(format('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud-zoom-loading" >Loading...</div>',b/3,b/2-b/6)).find(":last").css("opacity",.5)}},200);var z=function(){null!==r&&(r.remove(),r=null)};this.removeBits=function(){o&&(o.remove(),o=null),p&&(p.remove(),p=null),q&&(q.remove(),q=null),z(),$(".cloud-zoom-loading",a.parent()).remove()},this.destroy=function(){a.data("zoom",null),n&&(n.unbind(),n.remove(),n=null),m&&(m.remove(),m=null),this.removeBits()},this.fadedOut=function(){m&&(m.remove(),m=null),this.removeBits()},this.controlLoop=function(){if(o){var a=h-k.offset().left-.5*f>>0,c=i-k.offset().top-.5*g>>0;a<0?a=0:a>k.outerWidth()-f&&(a=k.outerWidth()-f),c<0?c=0:c>k.outerHeight()-g&&(c=k.outerHeight()-g),o.css({left:a,top:c}),o.css("background-position",-a+"px "+-c+"px"),t=a/k.outerWidth()*e.width>>0,u=c/k.outerHeight()*e.height>>0,w+=(t-w)/b.smoothMove,v+=(u-v)/b.smoothMove,m.css("background-position",-(w>>0)+"px "+(-(v>>0)+"px"))}s=setTimeout(function(){y.controlLoop()},30)},this.init2=function(a,b){x++,1===b&&(e=a),2===x&&this.init()},this.init=function(){$(".cloud-zoom-loading",a.parent()).remove(),n=a.parent().append(format("<div class='mousetrap' style='background:#fff;opacity:0;filter:alpha(opacity=0);z-index:99;position:absolute;width:%0px;height:%1px;left:%2px;top:%3px;'></div>",k.outerWidth(),k.outerHeight(),0,0)).find(":last"),n.bind("mousemove",this,function(a){h=a.pageX,i=a.pageY}),n.bind("mouseleave",this,function(a){return clearTimeout(s),o&&o.fadeOut(299),p&&p.fadeOut(299),q&&q.fadeOut(299),m.fadeOut(300,function(){y.fadedOut()}),!1}),n.bind("mouseenter",this,function(c){h=c.pageX,i=c.pageY,j=c.data,m&&(m.stop(!0,!1),m.remove());var d=b.adjustX,s=b.adjustY,t=k.outerWidth(),u=k.outerHeight(),v=b.zoomWidth,w=b.zoomHeight;"auto"==b.zoomWidth&&(v=l.outerWidth()),"auto"==b.zoomHeight&&(w=k.outerHeight());var x=a.parent();switch(b.position){case"top":s-=w;break;case"right":d+=t;break;case"bottom":s+=u;break;case"left":d-=v;break;case"inside":v=t,w=u;break;default:x=$("#"+b.position),x.length?(v=x.innerWidth(),w=x.innerHeight()):(x=a,d+=t,s+=u)}m=x.append(format('<div id="cloud-zoom-big" class="cloud-zoom-big" style="display:none;position:absolute;left:%0px;top:0px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:99;"></div>',d,s,v,w,e.src)).find(":last"),k.attr("title")&&b.showTitle&&m.append(format('<div class="cloud-zoom-title">%0</div>',k.attr("title"))).find(":last").css("opacity",b.titleOpacity),$.browser.msie&&$.browser.version<7&&(r=$('<iframe frameborder="0" src="#"></iframe>').css({position:"absolute",left:d,top:s,zIndex:99,width:v,height:w}).insertBefore(m)),m.fadeIn(500),o&&(o.remove(),o=null),"undefined"==typeof c.data.zoomDivWidth&&(c.data.zoomDivWidth=m.get(0).offsetWidth-1*m.css("border-left-width").replace(/\D/g,"")-1*m.css("border-right-width").replace(/\D/g,"")),"undefined"==typeof c.data.zoomDivHeight&&(c.data.zoomDivHeight=m.get(0).offsetHeight-1*m.css("border-top-width").replace(/\D/g,"")-1*m.css("border-bottom-width").replace(/\D/g,"")),f=k.outerWidth()/e.width*c.data.zoomDivWidth,g=k.outerHeight()/e.height*c.data.zoomDivHeight,o=a.append(format("<div class = 'cloud-zoom-lens' style='display:none;z-index:98;position:absolute;width:%0px;height:%1px;'></div>",f,g)).find(":last"),n.css("cursor",o.css("cursor"));var y=!1;b.tint&&(o.css("background",'url("'+k.attr("src")+'")'),p=a.append(format('<div style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',k.outerWidth(),k.outerHeight(),b.tint)).find(":last"),p.css("opacity",b.tintOpacity),y=!0,p.fadeIn(500)),b.softFocus&&(o.css("background",'url("'+k.attr("src")+'")'),q=a.append(format('<div style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',k.outerWidth()-2,k.outerHeight()-2,b.tint)).find(":last"),q.css("background",'url("'+k.attr("src")+'")'),q.css("opacity",.5),y=!0,q.fadeIn(500)),y||o.css("opacity",b.lensOpacity),"inside"!==b.position&&o.fadeIn(500),j.controlLoop()})},c=new Image,$(c).load(function(){y.init2(this,0)}),c.src=k.attr("src"),d=new Image,$(d).load(function(){y.init2(this,1)}),d.src=a.attr("href")}$(document).ready(function(){$(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()}),$.fn.CloudZoom=function(options){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}return this.each(function(){var relOpts,opts;eval("var    a = {"+$(this).attr("rel")+"}"),relOpts=a,$(this).is(".cloud-zoom")?($(this).css({position:"relative",display:"block"}),$("img",$(this)).css({display:"block"}),"wrap"!=$(this).parent().attr("id")&&$(this).wrap('<div id="wrap" style="top:0px;z-index:99;position:relative;"></div>'),opts=$.extend({},$.fn.CloudZoom.defaults,options),opts=$.extend({},opts,relOpts),$(this).data("zoom",new CloudZoom($(this),opts))):$(this).is(".cloud-zoom-gallery")&&(opts=$.extend({},relOpts,options),$(this).data("relOpts",opts),$(this).bind("click",$(this),function(a){var b=a.data.data("relOpts");return $("#"+b.useZoom).data("zoom").destroy(),$("#"+b.useZoom).attr("href",a.data.attr("href")),$("#"+b.useZoom+" img").attr("src",a.data.data("relOpts").smallImage),$("#"+a.data.data("relOpts").useZoom).CloudZoom(),!1}))}),this},$.fn.CloudZoom.defaults={zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:.5,lensOpacity:.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:.5,adjustX:0,adjustY:0}}(jQuery);